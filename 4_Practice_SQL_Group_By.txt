Let's practice:
First we use GROUP BY to group distinct values together and perform aggregation to get a single summarized value.
Then we use HAVING to filter that grouped/aggregated data.
And finally, we see WHERE for performance improvement — to filter unnecessary data before we deal with GROUP BY.
First run this to create table.

---

CREATE TABLE country (
    id INT PRIMARY KEY,
    continent VARCHAR(50),
    name VARCHAR(100),
    surface_area DECIMAL(12,2)
);

INSERT INTO country (id, continent, name, surfacearea) VALUES
(1, 'Asia', 'India', 328),
(2, 'Asia', 'China', 959),
(3, 'Europe', 'France', 551),
(4, 'Europe', 'Germany', 357),
(5, 'Africa', 'Egypt', 100),
(6, 'Africa', 'Nigeria', 923),
(7, 'North America', 'USA', 983),
(8, 'South America', 'Brazil', 851),
(9, 'Australia', 'Australia', 769),
(10, 'Antarctica', 'Antarctica', 140);

---

# Group By Clause: 

- Practical Demonstration: 
1. Retrieve all records from the `country` table.
2. Retrieve only the `name` column from the `country` table.
3. Determine the total number of countries available in the `country` table.
4. Calculate the number of countries present in each continent using the `GROUP BY` clause.
5. Display each continent along with the total count of countries associated with it.
6. Find the total number of countries whose surface area exceeds 900.
7. Display the continents along with their respective country counts, considering only those continents that have fewer than 2 countries.

---

# Sequence of using where, group by, having and order by clauses: 
 
- where > group by > having > order by 
- Practical Demonstration: 
Q. Retrieve each continent along with the number of countries whose surface area is greater than 300, considering only those continents that have fewer than 2 countries, and sort the result set in ascending order based on the country count.

---

CREATE TABLE country (
    id INT,
    continent VARCHAR(50),
    name VARCHAR(100),
    surfacearea DECIMAL(12,2)
);


INSERT INTO country (id, continent, name, surfacearea) VALUES
(1, 'Asia', 'India', 3287263),
(2, 'Asia', 'China', 9596961),
(3, 'Asia', 'india', 3287263),          -- Same name different case
(4, 'Europe', 'France', 551695),
(5, 'Europe', 'Germany', 357386),
(6, 'europe', 'France', 551695),        -- Case difference
(7, 'Africa', 'Egypt', 1002450),
(8, 'Africa', 'Egypt', NULL),           -- NULL value
(9, 'Africa', 'Nigeria', 923768),
(10, 'Asia', 'Japan', 377975),
(11, 'Asia', 'Japan', 377975),          -- exact duplicate
(12, 'North America', 'USA', 9833517),
(13, 'north america', 'Canada', 9984670),
(14, 'South America', 'Brazil', 8515767),
(15, 'South America', 'Argentina', 2780400),
(16, 'Australia', 'Australia', 7692024),
(17, 'Antarctica', 'Antarctica', NULL),
(18, 'Asia', 'Bhutan', 38394),
(19, 'Asia', 'Nepal', 147516),
(20, 'Asia', 'China', 9596961);         -- duplicate again

---

# Scenario-based interview questions:

1. Identify all country names that occur more than once within the same continent.

2. Retrieve all continents whose total surface area exceeds 20 million, excluding records where the surface area is NULL.

3. Identify all continents that contain at least one country with a NULL surface area.

4. Retrieve all continents that have more than three countries recorded in the table.

5. Group continents in a case-insensitive manner (for example, Asia and asia should be treated as the same) and return only those continents that have more than four records.

6. Identify all country names whose combined surface area, after merging duplicate country names, is greater than 1 million.

7. Retrieve all continents whose average surface area exceeds 2 million, excluding NULL values from the calculation.

8. List all country names that are associated with more than one continent.

9. Identify all continents where the minimum surface area among all countries is less than 50,000.

10. Identify continents for which the maximum and minimum surface area values are equal.

11. Retrieve all continents that contain more than one country with a NULL surface area.

12. Identify continents where a single country contributes more than 50 percent of the continent’s total surface area.

13. List all countries whose surface area is below 100,000, considering only continents that have more than three countries.

14. Identify all continents where the difference between the maximum and minimum surface area exceeds 5 million.

15. Retrieve all continents where the sum of surface areas differs from the sum of DISTINCT surface areas.


